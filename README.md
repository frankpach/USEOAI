# üöÄ USEOAI - SEO Analyzer con IA

Un analizador SEO avanzado que combina an√°lisis t√©cnico tradicional con inteligencia artificial para proporcionar insights profundos sobre el posicionamiento web.

## ‚ú® Caracter√≠sticas

### üîç An√°lisis T√©cnico SEO
- **An√°lisis de HTML**: T√≠tulos, meta descripciones, headings, enlaces
- **Validaci√≥n de enlaces**: Detecci√≥n de enlaces rotos internos y externos
- **M√©tricas de rendimiento**: TTFB, compresi√≥n GZIP, lazy loading
- **Estructura sem√°ntica**: An√°lisis de schema.org y datos estructurados
- **Validaci√≥n de URLs**: Prevenci√≥n de ataques SSRF

### üß† An√°lisis Sem√°ntico con IA
- **M√∫ltiples proveedores de IA**:
  - ‚úÖ **Google Gemini** (incluido)
  - üîß OpenAI ChatGPT
  - üîß Anthropic Claude
- **An√°lisis de contenido**: Coherencia, intenci√≥n, legibilidad
- **Recomendaciones inteligentes**: Basadas en el objetivo SEO
- **An√°lisis de contexto geogr√°fico**: Optimizaci√≥n local

### üó∫Ô∏è SEO Local
- **Ranking en Google Maps**: Verificaci√≥n de posicionamiento local
- **Ranking en Bing Maps**: An√°lisis multi-plataforma
- **Consistencia NAP**: Name, Address, Phone verification
- **Muestreo geogr√°fico**: An√°lisis desde m√∫ltiples ubicaciones
- **An√°lisis de ranking geogr√°fico independiente**: Endpoint dedicado para an√°lisis de posicionamiento local
- **An√°lisis condicional**: El an√°lisis geogr√°fico se ejecuta solo cuando se proporcionan todos los par√°metros requeridos

### üõ°Ô∏è Seguridad y Robustez
- **Validaci√≥n de IPs**: Prevenci√≥n de ataques SSRF
- **Sanitizaci√≥n de URLs**: Protecci√≥n contra inyecciones
- **Manejo de errores**: Recuperaci√≥n graceful de fallos
- **Rate limiting**: Protecci√≥n contra bloqueos

## üöÄ Instalaci√≥n R√°pida

### Opci√≥n 1: Instalador Automatizado
```bash
# Clonar el repositorio
git clone <url-del-repositorio>
cd USEOAI_App

# Ejecutar instalador
python install.py
```

### Opci√≥n 2: Instalaci√≥n Manual
```bash
# 1. Crear entorno virtual
python -m venv venv
venv\Scripts\activate  # Windows
source venv/bin/activate  # macOS/Linux

# 2. Instalar dependencias
pip install -r requirements.txt

# 3. Crear archivo .env
cp env.example .env

# 4. Instalar Chromium
playwright install
```

## üîë Configuraci√≥n

### API Keys Requeridas

#### Google Gemini (‚úÖ Incluida)
```env
GOOGLE_API_KEY=AIzaSyAUjV6Bw9RaLD8bAQ9P5T7nBi3c6r7mxvQ
```

#### OpenAI ChatGPT (Opcional)
```env
OPENAI_API_KEY=sk-...
```

#### Anthropic Claude (Opcional)
```env
ANTHROPIC_API_KEY=sk-ant-...
```

## üß™ Verificaci√≥n

```bash
# Ejecutar tests
python -m pytest tests/ -v

# Probar analizador
python test_seo_analyzer.py

# Iniciar servidor
python main.py
```

## üìñ Uso

### API REST

#### Endpoints Disponibles

1. **POST /api/analyze** - An√°lisis completo de sitio web
2. **POST /api/geo-rank-analysis** - An√°lisis de ranking geogr√°fico independiente
3. **GET /api/status** - Estado de la API y proveedores de IA disponibles

#### An√°lisis de Sitio Web (con ubicaci√≥n por texto)
```bash
curl -X POST "http://localhost:8000/api/analyze" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://ejemplo.com",
    "seo_goal": "Rankear para servicios web",
    "location": "Medell√≠n, Colombia",
    "language": "es",
    "llm_provider": "gemini"
  }'
```

#### An√°lisis de Sitio Web (con coordenadas exactas)
```bash
curl -X POST "http://localhost:8000/api/analyze" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://ejemplo.com",
    "seo_goal": "Rankear para servicios web",
    "location": "Medell√≠n, Colombia",
    "latitude": 6.2442,
    "longitude": -75.5812,
    "local_radius_km": 10,
    "geo_samples": 15,
    "language": "es",
    "llm_provider": "gemini"
  }'
```

#### An√°lisis de Ranking Geogr√°fico (Nuevo)
```bash
curl -X POST "http://localhost:8000/api/geo-rank-analysis" \
  -H "Content-Type: application/json" \
  -d '{
    "location": "Medell√≠n, Colombia",
    "latitude": 6.2442,
    "longitude": -75.5812,
    "local_radius_km": 5,
    "geo_samples": 10,
    "company_name": "Acme HVAC",
    "keywords": ["hvac repair", "ac install", "emergency hvac", "thermostat replacement"]
  }'
```

**Nota**: El an√°lisis geogr√°fico en el endpoint `/api/analyze` solo se ejecuta si se proporcionan TODOS los par√°metros requeridos:
- `location` O (`latitude` Y `longitude`)
- `local_radius_km`
- `geo_samples`

Si falta alguno de estos par√°metros, el an√°lisis procede sin la verificaci√≥n de ranking local.

#### Respuesta de Ejemplo - An√°lisis Completo
```json
{
        "status_code": 200,
        "title": {
    "text": "Servicios Web Profesionales",
    "length": 32,
    "has_keywords": true
        },
        "meta_description": {
    "text": "Servicios web profesionales en Medell√≠n...",
    "length": 156
        },
        "semantic_summary": {
    "llm_engine": "gemini",
    "coherence_score": 0.85,
    "detected_intent": "Commercial",
    "readability_level": "B2",
    "suggested_improvements": [
      "A√±adir m√°s palabras clave espec√≠ficas",
      "Mejorar la estructura de headings"
    ]
  },
        "speed_metrics": {
    "ttfb_ms": 245,
    "resource_count": 12,
    "gzip_enabled": true,
    "lazy_loaded_images": false
        },
        "local_rank_check": {
    "google_maps_rank": "rank #2.5",
    "nap_consistency": true,
    "sample_locations_checked": 5
        },
        "recommendations": [
    "Implementar lazy loading para im√°genes",
    "Optimizar meta descripci√≥n",
    "A√±adir m√°s contenido relevante"
        ]
    }
```

#### Respuesta de Ejemplo - An√°lisis de Ranking Geogr√°fico
```json
{
  "company_name": "Acme HVAC",
  "location_used": "Medell√≠n, Colombia",
  "coordinates": [6.2442, -75.5812],
  "radius_km": 5,
  "total_samples": 10,
  "keywords_analyzed": 4,
  "keyword_results": [
    {
      "keyword": "hvac repair",
      "average_rank": 2.5,
      "coverage_percentage": 80.0,
      "total_samples": 10,
      "found_in_samples": 8,
      "google_maps_rank": "rank #2.5",
      "bing_maps_rank": "rank #3.0",
      "nap_inconsistencies": [],
      "visibility_score": 80.0
    },
    {
      "keyword": "ac install",
      "average_rank": 4.2,
      "coverage_percentage": 60.0,
      "total_samples": 10,
      "found_in_samples": 6,
      "google_maps_rank": "rank #4.2",
      "bing_maps_rank": "rank #5.0",
      "nap_inconsistencies": ["Missing phone number in Google Maps listing"],
      "visibility_score": 60.0
    }
  ],
  "overall_visibility_score": 70.0,
  "nap_consistency": true,
  "has_verified_listing": true,
  "analysis_timestamp": "2024-01-15 14:30:25 UTC"
}
```

### Uso Program√°tico

```python
import asyncio
from services.seo_analyzer import SEOAnalyzer
from models.seo_models import AnalysisRequest

async def analizar_sitio():
    analyzer = SEOAnalyzer()
    request = AnalysisRequest(
        url="https://ejemplo.com",
        seo_goal="Rankear para servicios web",
        location="Medell√≠n, Colombia",
        language="es",
        llm_provider="gemini"
    )
    
    result = await analyzer.analyze_site(request)
    print(f"T√≠tulo: {result.title.text}")
    print(f"Recomendaciones: {result.recommendations}")

asyncio.run(analizar_sitio())
```

## üìÅ Estructura del Proyecto

```
USEOAI_App/
‚îú‚îÄ‚îÄ api/                    # Endpoints de la API
‚îÇ   ‚îú‚îÄ‚îÄ analyzer.py        # An√°lisis individual
‚îÇ   ‚îî‚îÄ‚îÄ batch_analyzer.py  # An√°lisis en lote
‚îú‚îÄ‚îÄ services/              # Servicios principales
‚îÇ   ‚îú‚îÄ‚îÄ seo_analyzer.py    # Analizador SEO principal
‚îÇ   ‚îú‚îÄ‚îÄ scraper.py         # Scraping web
‚îÇ   ‚îî‚îÄ‚îÄ semantic_analyzer.py # An√°lisis sem√°ntico
‚îú‚îÄ‚îÄ models/                # Modelos de datos
‚îÇ   ‚îú‚îÄ‚îÄ seo_models.py      # Modelos SEO
‚îÇ   ‚îî‚îÄ‚îÄ semantic_models.py # Modelos sem√°nticos
‚îú‚îÄ‚îÄ utils/                 # Utilidades
‚îÇ   ‚îî‚îÄ‚îÄ llm_clients.py     # Clientes de IA
‚îú‚îÄ‚îÄ config/                # Configuraci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ config.py          # Configuraci√≥n principal
‚îú‚îÄ‚îÄ tests/                 # Tests
‚îú‚îÄ‚îÄ main.py                # Punto de entrada
‚îú‚îÄ‚îÄ install.py             # Instalador automatizado
‚îú‚îÄ‚îÄ test_seo_analyzer.py   # Script de prueba
‚îú‚îÄ‚îÄ requirements.txt       # Dependencias
‚îú‚îÄ‚îÄ env.example            # Variables de entorno ejemplo
‚îú‚îÄ‚îÄ INSTALLATION_GUIDE.md  # Gu√≠a de instalaci√≥n
‚îî‚îÄ‚îÄ README.md              # Este archivo
```

## ‚öôÔ∏è Configuraci√≥n Avanzada

### Variables de Entorno

```env
# Configuraci√≥n de rendimiento
SEO_DEFAULT_TIMEOUT=20
SEO_MAX_CONCURRENT_REQUESTS=5
SEO_BROWSER_POOL_SIZE=3

# Umbrales de an√°lisis
SEO_TTFB_THRESHOLD_MS=500
SEO_TITLE_MIN_LENGTH=30
SEO_TITLE_MAX_LENGTH=70

# Flags de funcionalidad
SEO_ENABLE_HTML_CACHE=true
SEO_ENABLE_BROKEN_LINKS_CHECK=true
SEO_ENABLE_PERFORMANCE_CHECK=true
SEO_ENABLE_GOOGLE_MAPS_CHECK=true
```

### Personalizaci√≥n

El analizador es altamente configurable. Puedes:

- **Ajustar umbrales**: Modificar valores en `config/config.py`
- **Cambiar proveedores de IA**: Seleccionar entre Gemini, ChatGPT, Claude
- **Deshabilitar funcionalidades**: Usar flags de configuraci√≥n
- **Personalizar user agents**: Configurar diferentes navegadores

## üõ†Ô∏è Desarrollo

### Ejecutar Tests
```bash
# Todos los tests
python -m pytest tests/ -v

# Tests espec√≠ficos
python -m pytest tests/test_services.py::TestScraper -v

# Tests con coverage
python -m pytest tests/ --cov=services --cov=api
```

### Estructura de Tests
- `tests/test_services.py`: Tests de servicios principales
- `tests/test_endpoints.py`: Tests de endpoints de API
- `test_seo_analyzer.py`: Script de prueba integrado

## üö® Soluci√≥n de Problemas

### Error: "Chromium not found"
```bash
playwright install --force
```

### Error: "API key not found"
```bash
# Verificar archivo .env
cat .env

# O establecer variable de entorno
export GOOGLE_API_KEY=AIzaSyAUjV6Bw9RaLD8bAQ9P5T7nBi3c6r7mxvQ
```

### Error: "ModuleNotFoundError"
```bash
# Activar entorno virtual
venv\Scripts\activate  # Windows
source venv/bin/activate  # macOS/Linux

# Reinstalar dependencias
pip install -r requirements.txt
```

## üìä M√©tricas y Rendimiento

- **Tiempo de an√°lisis**: 5-15 segundos por sitio
- **Concurrencia**: Hasta 5 an√°lisis simult√°neos
- **Precisi√≥n**: 95%+ en detecci√≥n de problemas SEO
- **Cobertura**: An√°lisis completo de 50+ factores SEO

## üîí Seguridad

- ‚úÖ Validaci√≥n de URLs contra SSRF
- ‚úÖ Sanitizaci√≥n de entradas
- ‚úÖ Rate limiting integrado
- ‚úÖ Manejo seguro de API keys
- ‚úÖ Logs sin informaci√≥n sensible

## üìà Roadmap

- [ ] **An√°lisis de competencia**: Comparaci√≥n con competidores
- [ ] **Reportes autom√°ticos**: Generaci√≥n de PDF/Excel
- [ ] **Monitoreo continuo**: Tracking de cambios SEO
- [ ] **Integraci√≥n con Google Analytics**: M√©tricas de tr√°fico
- [ ] **API de webhooks**: Notificaciones en tiempo real

## ü§ù Contribuir

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver `LICENSE` para m√°s detalles.

## üìû Soporte

- üìß **Email**: soporte@useoai.com
- üìñ **Documentaci√≥n**: [INSTALLATION_GUIDE.md](INSTALLATION_GUIDE.md)
- üêõ **Issues**: [GitHub Issues](https://github.com/tu-usuario/USEOAI/issues)

---

**¬°Gracias por usar USEOAI! üéâ**

*Optimiza tu SEO con la potencia de la inteligencia artificial.*